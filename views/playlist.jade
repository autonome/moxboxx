extend layout

block title
  = ': ' + playlist.title

block content
  h1#playlist-title
    span.title= playlist.title
    span.description= playlist.description
    if session.email && isOwner
      a(href='/playlist/edit/#{playlist.id}', class='playlist-edit') Edit

  ul#playlist-tags
    if playlist.tags.length > 0
      for tag in playlist.tags
        li(data-action='/tag/#{playlist.id}', data-tag='#{tag.name}')
          a(href='/tag/#{tag.name}')= tag.name

  .playlist-wrapper
    .playlist-item
      h3= 'Created by ' + playlist.owner.username
      a(href='/user/#{playlist.owner.id}')
        img(src='#{playlist.owner.gravatar}')
      time= playlist.created

      if session.email
        .item-actions
          if playlist.isStarred
            a(href='javascript:;', data-id='#{playlist.id}', class='playlist-star on', data-action='/playlist/star/', data-context='playlist-star') unstar
          else
            a(href='javascript:;', data-id='#{playlist.id}', class='playlist-star', data-action='/playlist/star/', data-context='playlist-star') star

      if playlist.starredBy.length > 0
        #starred
          h3 Starred By
          ul
            for user in playlist.starredBy
              li
                a(href='/user/#{user.id}', title="#{user.username}")
                  img(src='#{user.gravatar}')

    ol#moxlist
      for mox in moxes
        li(data-id='#{mox.id}', data-playlistid='#{mox.playlist_id}', data-action='/mox/', class='item')
          != mox.content
          if session.email && isOwner
            .item-actions
              a(href='javascript:;', class='mox-delete', data-context='mox-delete') delete

block footer
  if moxes.length > 0
    a(href='javascript:;', id='play-playlist', title='Start playlist') play
    a(href='javascript:;', id='repeat-playlist', title='Repeat playlist') repeat

